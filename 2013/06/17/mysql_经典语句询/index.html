<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"zecheng.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"hide","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="mysql_经典语句询">
<meta property="og:type" content="article">
<meta property="og:title" content="mysql_经典语句询">
<meta property="og:url" content="https://zecheng.github.io/2013/06/17/mysql_%E7%BB%8F%E5%85%B8%E8%AF%AD%E5%8F%A5%E8%AF%A2/index.html">
<meta property="og:site_name" content="泽宬的技术博客">
<meta property="og:description" content="mysql_经典语句询">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2013-06-17T14:51:36.000Z">
<meta property="article:modified_time" content="2018-10-14T04:08:28.000Z">
<meta property="article:author" content="泽宬">
<meta property="article:tag" content="MySql">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://zecheng.github.io/2013/06/17/mysql_%E7%BB%8F%E5%85%B8%E8%AF%AD%E5%8F%A5%E8%AF%A2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>mysql_经典语句询 | 泽宬的技术博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">泽宬的技术博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-links">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>links</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404.html" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zecheng.github.io/2013/06/17/mysql_%E7%BB%8F%E5%85%B8%E8%AF%AD%E5%8F%A5%E8%AF%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泽宬">
      <meta itemprop="description" content="路虽遥,行必至.事虽难,做必成.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泽宬的技术博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          mysql_经典语句询
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2013-06-17 22:51:36" itemprop="dateCreated datePublished" datetime="2013-06-17T22:51:36+08:00">2013-06-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2018-10-14 12:08:28" itemprop="dateModified" datetime="2018-10-14T12:08:28+08:00">2018-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MySql/" itemprop="url" rel="index"><span itemprop="name">MySql</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>19k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>17 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>mysql_经典语句询</p>
<span id="more"></span>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span>、说明：创建数据库</span><br><span class="line"><span class="keyword">CREATE</span> DATABASE database<span class="operator">-</span>name</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、说明：删除数据库</span><br><span class="line"><span class="keyword">drop</span> database dbname</span><br><span class="line"><span class="number">3</span>、说明：备份<span class="keyword">sql</span> server</span><br><span class="line"><span class="comment">--- 创建 备份数据的 device</span></span><br><span class="line">USE master</span><br><span class="line"><span class="keyword">EXEC</span> sp_addumpdevice &quot;disk&quot;, &quot;testBack&quot;, &quot;c:mssql7backupMyNwind_1.dat&quot;</span><br><span class="line"><span class="comment">--- 开始 备份</span></span><br><span class="line">BACKUP DATABASE pubs <span class="keyword">TO</span> testBack </span><br><span class="line"><span class="number">4</span>、说明：创建新表</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tabname(col1 type1 [<span class="keyword">not</span> <span class="keyword">null</span>] [<span class="keyword">primary</span> key],col2 type2 [<span class="keyword">not</span> <span class="keyword">null</span>],..)</span><br><span class="line">根据已有的表创建新表： </span><br><span class="line">A：<span class="keyword">create</span> <span class="keyword">table</span> tab_new <span class="keyword">like</span> tab_old (使用旧表创建新表)</span><br><span class="line">B：<span class="keyword">create</span> <span class="keyword">table</span> tab_new <span class="keyword">as</span> <span class="keyword">select</span> col1,col2… <span class="keyword">from</span> tab_old definition <span class="keyword">only</span></span><br><span class="line"><span class="number">5</span>、说明：删除新表</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> tabname </span><br><span class="line"><span class="number">6</span>、说明：增加一个列</span><br><span class="line"><span class="keyword">Alter</span> <span class="keyword">table</span> tabname <span class="keyword">add</span> <span class="keyword">column</span> col type</span><br><span class="line">注：列增加后将不能删除。DB2中列加上后数据类型也不能改变，唯一能改变的是增加<span class="type">varchar</span>类型的长度。</span><br><span class="line"><span class="number">7</span>、说明：添加主键： <span class="keyword">Alter</span> <span class="keyword">table</span> tabname <span class="keyword">add</span> <span class="keyword">primary</span> key(col) </span><br><span class="line">说明：删除主键： <span class="keyword">Alter</span> <span class="keyword">table</span> tabname <span class="keyword">drop</span> <span class="keyword">primary</span> key(col) </span><br><span class="line"><span class="number">8</span>、说明：创建索引：<span class="keyword">create</span> [<span class="keyword">unique</span>] index idxname <span class="keyword">on</span> tabname(col….) </span><br><span class="line">删除索引：<span class="keyword">drop</span> index idxname</span><br><span class="line">注：索引是不可更改的，想更改必须删除重新建。</span><br><span class="line"><span class="number">9</span>、说明：创建视图：<span class="keyword">create</span> <span class="keyword">view</span> viewname <span class="keyword">as</span> <span class="keyword">select</span> statement </span><br><span class="line">删除视图：<span class="keyword">drop</span> <span class="keyword">view</span> viewname</span><br><span class="line"><span class="number">10</span>、说明：几个简单的基本的<span class="keyword">sql</span>语句</span><br><span class="line">选择：<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> table1 <span class="keyword">where</span> 范围</span><br><span class="line">插入：<span class="keyword">insert</span> <span class="keyword">into</span> table1(field1,field2) <span class="keyword">values</span>(value1,value2)</span><br><span class="line">删除：<span class="keyword">delete</span> <span class="keyword">from</span> table1 <span class="keyword">where</span> 范围</span><br><span class="line">更新：update table1 <span class="keyword">set</span> field1<span class="operator">=</span>value1 <span class="keyword">where</span> 范围</span><br><span class="line">查找：<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> table1 <span class="keyword">where</span> field1 <span class="keyword">like</span> ’<span class="operator">%</span>value1<span class="operator">%</span>’ <span class="comment">---like的语法很精妙，查资料!</span></span><br><span class="line">排序：<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> table1 <span class="keyword">order</span> <span class="keyword">by</span> field1,field2 [<span class="keyword">desc</span>]</span><br><span class="line">总数：<span class="keyword">select</span> count <span class="keyword">as</span> totalcount <span class="keyword">from</span> table1</span><br><span class="line">求和：<span class="keyword">select</span> <span class="built_in">sum</span>(field1) <span class="keyword">as</span> sumvalue <span class="keyword">from</span> table1</span><br><span class="line">平均：<span class="keyword">select</span> <span class="built_in">avg</span>(field1) <span class="keyword">as</span> avgvalue <span class="keyword">from</span> table1</span><br><span class="line">最大：<span class="keyword">select</span> <span class="built_in">max</span>(field1) <span class="keyword">as</span> maxvalue <span class="keyword">from</span> table1</span><br><span class="line">最小：<span class="keyword">select</span> <span class="built_in">min</span>(field1) <span class="keyword">as</span> minvalue <span class="keyword">from</span> table1</span><br><span class="line"><span class="number">11</span>、说明：几个高级查询运算词</span><br><span class="line">A： <span class="keyword">UNION</span> 运算符 </span><br><span class="line"><span class="keyword">UNION</span> 运算符通过组合其他两个结果表（例如 TABLE1 和 TABLE2）并消去表中任何重复行而派生出一个结果表。当 <span class="keyword">ALL</span> 随 <span class="keyword">UNION</span> 一起使用时（即 <span class="keyword">UNION</span> <span class="keyword">ALL</span>），不消除重复行。两种情况下，派生表的每一行不是来自 TABLE1 就是来自 TABLE2。 </span><br><span class="line">B： <span class="keyword">EXCEPT</span> 运算符 </span><br><span class="line"><span class="keyword">EXCEPT</span> 运算符通过包括所有在 TABLE1 中但不在 TABLE2 中的行并消除所有重复行而派生出一个结果表。当 <span class="keyword">ALL</span> 随 <span class="keyword">EXCEPT</span> 一起使用时 (<span class="keyword">EXCEPT</span> <span class="keyword">ALL</span>)，不消除重复行。 </span><br><span class="line">C： <span class="keyword">INTERSECT</span> 运算符</span><br><span class="line"><span class="keyword">INTERSECT</span> 运算符通过只包括 TABLE1 和 TABLE2 中都有的行并消除所有重复行而派生出一个结果表。当 <span class="keyword">ALL</span> 随 <span class="keyword">INTERSECT</span> 一起使用时 (<span class="keyword">INTERSECT</span> <span class="keyword">ALL</span>)，不消除重复行。 </span><br><span class="line">注：使用运算词的几个查询结果行必须是一致的。 </span><br><span class="line"><span class="number">12</span>、说明：使用外连接 </span><br><span class="line">A、<span class="keyword">left</span> （<span class="keyword">outer</span>） <span class="keyword">join</span>： </span><br><span class="line">左外连接（左连接）：结果集几包括连接表的匹配行，也包括左连接表的所有行。 </span><br><span class="line"><span class="keyword">SQL</span>: <span class="keyword">select</span> a.a, a.b, a.c, b.c, b.d, b.f <span class="keyword">from</span> a <span class="keyword">LEFT</span> <span class="keyword">OUT</span> <span class="keyword">JOIN</span> b <span class="keyword">ON</span> a.a <span class="operator">=</span> b.c</span><br><span class="line">B：<span class="keyword">right</span> （<span class="keyword">outer</span>） <span class="keyword">join</span>: </span><br><span class="line">右外连接(右连接)：结果集既包括连接表的匹配连接行，也包括右连接表的所有行。 </span><br><span class="line">C：<span class="keyword">full</span><span class="operator">/</span><span class="keyword">cross</span> （<span class="keyword">outer</span>） <span class="keyword">join</span>： </span><br><span class="line">全外连接：不仅包括符号连接表的匹配行，还包括两个连接表中的所有记录。</span><br><span class="line"><span class="number">12</span>、分组:<span class="keyword">Group</span> <span class="keyword">by</span>:</span><br><span class="line">    一张表，一旦分组 完成后，查询后只能得到组相关的信息。</span><br><span class="line">    组相关的信息：（统计信息） count,sum,max,min,avg  分组的标准)</span><br><span class="line">    在SQLServer中分组时：不能以text,ntext,image类型的字段作为分组依据</span><br><span class="line">    在selecte统计函数中的字段，不能和普通的字段放在一起；</span><br><span class="line"><span class="number">13</span>、对数据库进行操作：</span><br><span class="line">    分离数据库： sp_detach_db; 附加数据库：sp_attach_db 后接表明，附加需要完整的路径名</span><br><span class="line"><span class="number">14.</span>如何修改数据库的名称:</span><br><span class="line">sp_renamedb &quot;old_name&quot;, &quot;new_name&quot;</span><br><span class="line"> </span><br><span class="line">二、提升</span><br><span class="line"><span class="number">1</span>、说明：复制表(只复制结构,源表名：a 新表名：b) (Access可用)</span><br><span class="line">法一：<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">into</span> b <span class="keyword">from</span> a <span class="keyword">where</span> <span class="number">1</span><span class="operator">&lt;&gt;</span><span class="number">1</span>（仅用于SQlServer）</span><br><span class="line">法二：<span class="keyword">select</span> top <span class="number">0</span> <span class="operator">*</span> <span class="keyword">into</span> b <span class="keyword">from</span> a</span><br><span class="line"><span class="number">2</span>、说明：拷贝表(拷贝数据,源表名：a 目标表名：b) (Access可用)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> b(a, b, c) <span class="keyword">select</span> d,e,f <span class="keyword">from</span> b;</span><br><span class="line"><span class="number">3</span>、说明：跨数据库之间表的拷贝(具体数据使用绝对路径) (Access可用)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> b(a, b, c) <span class="keyword">select</span> d,e,f <span class="keyword">from</span> b <span class="keyword">in</span> ‘具体数据库’ <span class="keyword">where</span> 条件</span><br><span class="line">例子：..<span class="keyword">from</span> b <span class="keyword">in</span> &quot;&quot;<span class="operator">&amp;</span>amp;Server.MapPath(&quot;.&quot;)<span class="operator">&amp;</span>amp;&quot;data.mdb&quot; <span class="operator">&amp;</span>amp;&quot;&quot; where..</span><br><span class="line"><span class="number">4</span>、说明：子查询(表名<span class="number">1</span>：a 表名<span class="number">2</span>：b)</span><br><span class="line"><span class="keyword">select</span> a,b,c <span class="keyword">from</span> a <span class="keyword">where</span> a <span class="keyword">IN</span> (<span class="keyword">select</span> d <span class="keyword">from</span> b ) 或者: <span class="keyword">select</span> a,b,c <span class="keyword">from</span> a <span class="keyword">where</span> a <span class="keyword">IN</span> (<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line"><span class="number">5</span>、说明：显示文章、提交人和最后回复时间</span><br><span class="line"><span class="keyword">select</span> a.title,a.username,b.adddate <span class="keyword">from</span> <span class="keyword">table</span> a,(<span class="keyword">select</span> <span class="built_in">max</span>(adddate) adddate <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">where</span> table.title<span class="operator">=</span>a.title) b</span><br><span class="line"><span class="number">6</span>、说明：外连接查询(表名<span class="number">1</span>：a 表名<span class="number">2</span>：b)</span><br><span class="line"><span class="keyword">select</span> a.a, a.b, a.c, b.c, b.d, b.f <span class="keyword">from</span> a <span class="keyword">LEFT</span> <span class="keyword">OUT</span> <span class="keyword">JOIN</span> b <span class="keyword">ON</span> a.a <span class="operator">=</span> b.c</span><br><span class="line"><span class="number">7</span>、说明：在线视图查询(表名<span class="number">1</span>：a )</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">SELECT</span> a,b,c <span class="keyword">FROM</span> a) T <span class="keyword">where</span> t.a <span class="operator">&gt;</span> <span class="number">1</span>;</span><br><span class="line"><span class="number">8</span>、说明：<span class="keyword">between</span>的用法,<span class="keyword">between</span>限制查询数据范围时包括了边界值,<span class="keyword">not</span> <span class="keyword">between</span>不包括</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> table1 <span class="keyword">where</span> <span class="type">time</span> <span class="keyword">between</span> time1 <span class="keyword">and</span> time2</span><br><span class="line"><span class="keyword">select</span> a,b,c, <span class="keyword">from</span> table1 <span class="keyword">where</span> a <span class="keyword">not</span> <span class="keyword">between</span> 数值<span class="number">1</span> <span class="keyword">and</span> 数值<span class="number">2</span></span><br><span class="line"><span class="number">9</span>、说明：<span class="keyword">in</span> 的使用方法</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> table1 <span class="keyword">where</span> a [<span class="keyword">not</span>] <span class="keyword">in</span> (‘值<span class="number">1</span>’,’值<span class="number">2</span>’,’值<span class="number">4</span>’,’值<span class="number">6</span>’)</span><br><span class="line"><span class="number">10</span>、说明：两张关联表，删除主表中已经在副表中没有的信息 </span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> table1 <span class="keyword">where</span> <span class="keyword">not</span> <span class="keyword">exists</span> ( <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> table2 <span class="keyword">where</span> table1.field1<span class="operator">=</span>table2.field1 )</span><br><span class="line"><span class="number">11</span>、说明：四表联查问题：</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> a <span class="keyword">left</span> <span class="keyword">inner</span> <span class="keyword">join</span> b <span class="keyword">on</span> a.a<span class="operator">=</span>b.b <span class="keyword">right</span> <span class="keyword">inner</span> <span class="keyword">join</span> c <span class="keyword">on</span> a.a<span class="operator">=</span>c.c <span class="keyword">inner</span> <span class="keyword">join</span> d <span class="keyword">on</span> a.a<span class="operator">=</span>d.d <span class="keyword">where</span> .....</span><br><span class="line"><span class="number">12</span>、说明：日程安排提前五分钟提醒 </span><br><span class="line"><span class="keyword">SQL</span>: <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 日程安排 <span class="keyword">where</span> datediff(&quot;minute&quot;,f开始时间,getdate())<span class="operator">&gt;</span><span class="number">5</span></span><br><span class="line"><span class="number">13</span>、说明：一条<span class="keyword">sql</span> 语句搞定数据库分页</span><br><span class="line"><span class="keyword">select</span> top <span class="number">10</span> b.<span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> top <span class="number">20</span> 主键字段,排序字段 <span class="keyword">from</span> 表名 <span class="keyword">order</span> <span class="keyword">by</span> 排序字段 <span class="keyword">desc</span>) a,表名 b <span class="keyword">where</span> b.主键字段 <span class="operator">=</span> a.主键字段 <span class="keyword">order</span> <span class="keyword">by</span> a.排序字段</span><br><span class="line">具体实现：</span><br><span class="line">关于数据库分页：</span><br><span class="line">  <span class="keyword">declare</span> <span class="variable">@start</span> <span class="type">int</span>,<span class="variable">@end</span> <span class="type">int</span></span><br><span class="line">  <span class="variable">@sql</span>  nvarchar(<span class="number">600</span>)</span><br><span class="line">  <span class="keyword">set</span> <span class="variable">@sql</span><span class="operator">=</span>’<span class="keyword">select</span> top’<span class="operator">+</span>str(<span class="variable">@end</span><span class="operator">-</span><span class="variable">@start</span><span class="operator">+</span><span class="number">1</span>)<span class="operator">+</span>’<span class="operator">+</span><span class="keyword">from</span> T <span class="keyword">where</span> rid <span class="keyword">not</span> <span class="keyword">in</span>(<span class="keyword">select</span> top’<span class="operator">+</span>str(<span class="variable">@str</span><span class="number">-1</span>)<span class="operator">+</span>’Rid <span class="keyword">from</span> T <span class="keyword">where</span> Rid<span class="operator">&gt;</span><span class="number">-1</span>)’</span><br><span class="line">  <span class="keyword">exec</span> sp_executesql <span class="variable">@sql</span></span><br><span class="line"> </span><br><span class="line">注意：在top后不能直接跟一个变量，所以在实际应用中只有这样的进行特殊的处理。Rid为一个标识列，如果top后还有具体的字段，这样做是非常有好处的。因为这样可以避免 top的字段如果是逻辑索引的，查询的结果后实际表中的不一致（逻辑索引中的数据有可能和数据表中的不一致，而查询时如果处在索引则首先查询索引）</span><br><span class="line"><span class="number">14</span>、说明：前<span class="number">10</span>条记录</span><br><span class="line"><span class="keyword">select</span> top <span class="number">10</span> <span class="operator">*</span> form table1 <span class="keyword">where</span> 范围</span><br><span class="line"><span class="number">15</span>、说明：选择在每一组b值相同的数据中对应的a最大的记录的所有信息(类似这样的用法可以用于论坛每月排行榜,每月热销产品分析,按科目成绩排名,等等.)</span><br><span class="line"><span class="keyword">select</span> a,b,c <span class="keyword">from</span> tablename ta <span class="keyword">where</span> a<span class="operator">=</span>(<span class="keyword">select</span> <span class="built_in">max</span>(a) <span class="keyword">from</span> tablename tb <span class="keyword">where</span> tb.b<span class="operator">=</span>ta.b)</span><br><span class="line"><span class="number">16</span>、说明：包括所有在 TableA 中但不在 TableB和TableC 中的行并消除所有重复行而派生出一个结果表</span><br><span class="line">(<span class="keyword">select</span> a <span class="keyword">from</span> tableA ) <span class="keyword">except</span> (<span class="keyword">select</span> a <span class="keyword">from</span> tableB) <span class="keyword">except</span> (<span class="keyword">select</span> a <span class="keyword">from</span> tableC)</span><br><span class="line"><span class="number">17</span>、说明：随机取出<span class="number">10</span>条数据</span><br><span class="line"><span class="keyword">select</span> top <span class="number">10</span> <span class="operator">*</span> <span class="keyword">from</span> tablename <span class="keyword">order</span> <span class="keyword">by</span> newid()</span><br><span class="line"><span class="number">18</span>、说明：随机选择记录</span><br><span class="line"><span class="keyword">select</span> newid()</span><br><span class="line"><span class="number">19</span>、说明：删除重复记录</span><br><span class="line"><span class="number">1</span>),<span class="keyword">delete</span> <span class="keyword">from</span> tablename <span class="keyword">where</span> id <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> <span class="built_in">max</span>(id) <span class="keyword">from</span> tablename <span class="keyword">group</span> <span class="keyword">by</span> col1,col2,...)</span><br><span class="line"><span class="number">2</span>),<span class="keyword">select</span> <span class="keyword">distinct</span> <span class="operator">*</span> <span class="keyword">into</span> temp <span class="keyword">from</span> tablename</span><br><span class="line">  <span class="keyword">delete</span> <span class="keyword">from</span> tablename</span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> tablename <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> temp</span><br><span class="line">评价： 这种操作牵连大量的数据的移动，这种做法不适合大容量但数据操作</span><br><span class="line"><span class="number">3</span>),例如：在一个外部表中导入数据，由于某些原因第一次只导入了一部分，但很难判断具体位置，这样只有在下一次全部导入，这样也就产生好多重复的字段，怎样删除重复字段</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tablename</span><br><span class="line"><span class="comment">--添加一个自增列</span></span><br><span class="line"><span class="keyword">add</span>  column_b <span class="type">int</span> <span class="keyword">identity</span>(<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"> <span class="keyword">delete</span> <span class="keyword">from</span> tablename <span class="keyword">where</span> column_b <span class="keyword">not</span> <span class="keyword">in</span>(</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(column_b)  <span class="keyword">from</span> tablename <span class="keyword">group</span> <span class="keyword">by</span> column1,column2,...)</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tablename <span class="keyword">drop</span> <span class="keyword">column</span> column_b</span><br><span class="line"><span class="number">20</span>、说明：列出数据库里所有的表名</span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">from</span> sysobjects <span class="keyword">where</span> type<span class="operator">=</span>&quot;U&quot; <span class="operator">/</span><span class="operator">/</span> U代表用户</span><br><span class="line"><span class="number">21</span>、说明：列出表里的所有的列名</span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">from</span> syscolumns <span class="keyword">where</span> id<span class="operator">=</span>object_id(&quot;TableName&quot;)</span><br><span class="line"><span class="number">22</span>、说明：列示type、vender、pcs字段，以type字段排列，<span class="keyword">case</span>可以方便地实现多重选择，类似<span class="keyword">select</span> 中的<span class="keyword">case</span>。</span><br><span class="line"><span class="keyword">select</span> type,<span class="built_in">sum</span>(<span class="keyword">case</span> vender <span class="keyword">when</span> &quot;A&quot; <span class="keyword">then</span> pcs <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>),<span class="built_in">sum</span>(<span class="keyword">case</span> vender <span class="keyword">when</span> &quot;C&quot; <span class="keyword">then</span> pcs <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>),<span class="built_in">sum</span>(<span class="keyword">case</span> vender <span class="keyword">when</span> &quot;B&quot; <span class="keyword">then</span> pcs <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="keyword">FROM</span> tablename <span class="keyword">group</span> <span class="keyword">by</span> type</span><br><span class="line">显示结果：</span><br><span class="line">type vender pcs</span><br><span class="line">电脑 A <span class="number">1</span></span><br><span class="line">电脑 A <span class="number">1</span></span><br><span class="line">光盘 B <span class="number">2</span></span><br><span class="line">光盘 A <span class="number">2</span></span><br><span class="line">手机 B <span class="number">3</span></span><br><span class="line">手机 C <span class="number">3</span></span><br><span class="line"><span class="number">23</span>、说明：初始化表table1</span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> table1</span><br><span class="line"><span class="number">24</span>、说明：选择从<span class="number">10</span>到<span class="number">15</span>的记录</span><br><span class="line"><span class="keyword">select</span> top <span class="number">5</span> <span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> top <span class="number">15</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">order</span> <span class="keyword">by</span> id <span class="keyword">asc</span>) table_别名 <span class="keyword">order</span> <span class="keyword">by</span> id <span class="keyword">desc</span></span><br><span class="line">三、技巧</span><br><span class="line"><span class="number">1</span>、<span class="number">1</span><span class="operator">=</span><span class="number">1</span>，<span class="number">1</span><span class="operator">=</span><span class="number">2</span>的使用，在<span class="keyword">SQL</span>语句组合时用的较多</span><br><span class="line">“<span class="keyword">where</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span>” 是表示选择全部    “<span class="keyword">where</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span>”全部不选，</span><br><span class="line">如：</span><br><span class="line">if <span class="variable">@strWhere</span> <span class="operator">!=</span>&quot;&quot;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@strSQL</span> <span class="operator">=</span> &quot;select count(*) as Total from [&quot; <span class="operator">+</span> <span class="variable">@tblName</span> <span class="operator">+</span> &quot;] where &quot; <span class="operator">+</span> <span class="variable">@strWhere</span> </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@strSQL</span> <span class="operator">=</span> &quot;select count(*) as Total from [&quot; <span class="operator">+</span> <span class="variable">@tblName</span> <span class="operator">+</span> &quot;]&quot;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">我们可以直接写成</span><br><span class="line">错误！未找到目录项。</span><br><span class="line"><span class="keyword">set</span> <span class="variable">@strSQL</span> <span class="operator">=</span> &quot;select count(*) as Total from [&quot; <span class="operator">+</span> <span class="variable">@tblName</span> <span class="operator">+</span> &quot;] where 1=1 安定 &quot;<span class="operator">+</span> <span class="variable">@strWhere</span> <span class="number">2</span>、收缩数据库</span><br><span class="line"><span class="comment">--重建索引</span></span><br><span class="line">DBCC REINDEX</span><br><span class="line">DBCC INDEXDEFRAG</span><br><span class="line"><span class="comment">--收缩数据和日志</span></span><br><span class="line">DBCC SHRINKDB</span><br><span class="line">DBCC SHRINKFILE</span><br><span class="line"><span class="number">3</span>、压缩数据库</span><br><span class="line">dbcc shrinkdatabase(dbname)</span><br><span class="line"><span class="number">4</span>、转移数据库给新用户以已存在用户权限</span><br><span class="line"><span class="keyword">exec</span> sp_change_users_login &quot;update_one&quot;,&quot;newname&quot;,&quot;oldname&quot;</span><br><span class="line">go</span><br><span class="line"><span class="number">5</span>、检查备份集</span><br><span class="line">RESTORE VERIFYONLY <span class="keyword">from</span> disk<span class="operator">=</span>&quot;E:dvbbs.bak&quot;</span><br><span class="line"><span class="number">6</span>、修复数据库</span><br><span class="line"><span class="keyword">ALTER</span> DATABASE [dvbbs] <span class="keyword">SET</span> SINGLE_USER</span><br><span class="line">GO</span><br><span class="line">DBCC CHECKDB(&quot;dvbbs&quot;,repair_allow_data_loss) <span class="keyword">WITH</span> TABLOCK</span><br><span class="line">GO</span><br><span class="line"><span class="keyword">ALTER</span> DATABASE [dvbbs] <span class="keyword">SET</span> MULTI_USER</span><br><span class="line">GO</span><br><span class="line"><span class="number">7</span>、日志清除</span><br><span class="line"><span class="keyword">SET</span> NOCOUNT <span class="keyword">ON</span></span><br><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@LogicalFileName</span> sysname,</span><br><span class="line"> <span class="variable">@MaxMinutes</span> <span class="type">INT</span>,</span><br><span class="line"> <span class="variable">@NewSize</span> <span class="type">INT</span></span><br><span class="line"> </span><br><span class="line">USE tablename <span class="comment">-- 要操作的数据库名</span></span><br><span class="line"><span class="keyword">SELECT</span>  <span class="variable">@LogicalFileName</span> <span class="operator">=</span> &quot;tablename_log&quot;, <span class="comment">-- 日志文件名</span></span><br><span class="line"><span class="variable">@MaxMinutes</span> <span class="operator">=</span> <span class="number">10</span>, <span class="comment">-- Limit on time allowed to wrap log.</span></span><br><span class="line"> <span class="variable">@NewSize</span> <span class="operator">=</span> <span class="number">1</span>  <span class="comment">-- 你想设定的日志文件的大小(M)</span></span><br><span class="line">Setup <span class="operator">/</span> initialize</span><br><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@OriginalSize</span> <span class="type">int</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@OriginalSize</span> <span class="operator">=</span> size</span><br><span class="line"> <span class="keyword">FROM</span> sysfiles</span><br><span class="line"> <span class="keyword">WHERE</span> name <span class="operator">=</span> <span class="variable">@LogicalFileName</span></span><br><span class="line"><span class="keyword">SELECT</span> &quot;Original Size of &quot; <span class="operator">+</span> db_name() <span class="operator">+</span> &quot; LOG is &quot; <span class="operator">+</span> </span><br><span class="line"> <span class="keyword">CONVERT</span>(<span class="type">VARCHAR</span>(<span class="number">30</span>),<span class="variable">@OriginalSize</span>) <span class="operator">+</span> &quot; 8K pages or &quot; <span class="operator">+</span> </span><br><span class="line"> <span class="keyword">CONVERT</span>(<span class="type">VARCHAR</span>(<span class="number">30</span>),(<span class="variable">@OriginalSize</span><span class="operator">*</span><span class="number">8</span><span class="operator">/</span><span class="number">1024</span>)) <span class="operator">+</span> &quot;MB&quot;</span><br><span class="line"> <span class="keyword">FROM</span> sysfiles</span><br><span class="line"> <span class="keyword">WHERE</span> name <span class="operator">=</span> <span class="variable">@LogicalFileName</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> DummyTrans</span><br><span class="line"> (DummyColumn <span class="type">char</span> (<span class="number">8000</span>) <span class="keyword">not</span> <span class="keyword">null</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@Counter</span>    <span class="type">INT</span>,</span><br><span class="line"> <span class="variable">@StartTime</span> DATETIME,</span><br><span class="line"> <span class="variable">@TruncLog</span>   <span class="type">VARCHAR</span>(<span class="number">255</span>)</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@StartTime</span> <span class="operator">=</span> GETDATE(),</span><br><span class="line"> <span class="variable">@TruncLog</span> <span class="operator">=</span> &quot;BACKUP LOG &quot; <span class="operator">+</span> db_name() <span class="operator">+</span> &quot; WITH TRUNCATE_ONLY&quot;</span><br><span class="line">DBCC SHRINKFILE (<span class="variable">@LogicalFileName</span>, <span class="variable">@NewSize</span>)</span><br><span class="line"><span class="keyword">EXEC</span> (<span class="variable">@TruncLog</span>)</span><br><span class="line"><span class="comment">-- Wrap the log if necessary.</span></span><br><span class="line">WHILE <span class="variable">@MaxMinutes</span> <span class="operator">&gt;</span> DATEDIFF (mi, <span class="variable">@StartTime</span>, GETDATE()) <span class="comment">-- time has not expired</span></span><br><span class="line"> <span class="keyword">AND</span> <span class="variable">@OriginalSize</span> <span class="operator">=</span> (<span class="keyword">SELECT</span> size <span class="keyword">FROM</span> sysfiles <span class="keyword">WHERE</span> name <span class="operator">=</span> <span class="variable">@LogicalFileName</span>)  </span><br><span class="line"> <span class="keyword">AND</span> (<span class="variable">@OriginalSize</span> <span class="operator">*</span> <span class="number">8</span> <span class="operator">/</span><span class="number">1024</span>) <span class="operator">&gt;</span> <span class="variable">@NewSize</span>  </span><br><span class="line"> <span class="keyword">BEGIN</span> <span class="comment">-- Outer loop.</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@Counter</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"> WHILE   ((<span class="variable">@Counter</span> <span class="operator">&lt;</span> <span class="variable">@OriginalSize</span> <span class="operator">/</span> <span class="number">16</span>) <span class="keyword">AND</span> (<span class="variable">@Counter</span> <span class="operator">&lt;</span> <span class="number">50000</span>))</span><br><span class="line"> <span class="keyword">BEGIN</span> <span class="comment">-- update</span></span><br><span class="line"> <span class="keyword">INSERT</span> DummyTrans <span class="keyword">VALUES</span> (&quot;Fill Log&quot;) <span class="keyword">DELETE</span> DummyTrans</span><br><span class="line"> <span class="keyword">SELECT</span> <span class="variable">@Counter</span> <span class="operator">=</span> <span class="variable">@Counter</span> <span class="operator">+</span> <span class="number">1</span></span><br><span class="line"> <span class="keyword">END</span></span><br><span class="line"> <span class="keyword">EXEC</span> (<span class="variable">@TruncLog</span>)  </span><br><span class="line"> <span class="keyword">END</span></span><br><span class="line"><span class="keyword">SELECT</span> &quot;Final Size of &quot; <span class="operator">+</span> db_name() <span class="operator">+</span> &quot; LOG is &quot; <span class="operator">+</span></span><br><span class="line"> <span class="keyword">CONVERT</span>(<span class="type">VARCHAR</span>(<span class="number">30</span>),size) <span class="operator">+</span> &quot; 8K pages or &quot; <span class="operator">+</span> </span><br><span class="line"> <span class="keyword">CONVERT</span>(<span class="type">VARCHAR</span>(<span class="number">30</span>),(size<span class="operator">*</span><span class="number">8</span><span class="operator">/</span><span class="number">1024</span>)) <span class="operator">+</span> &quot;MB&quot;</span><br><span class="line"> <span class="keyword">FROM</span> sysfiles </span><br><span class="line"> <span class="keyword">WHERE</span> name <span class="operator">=</span> <span class="variable">@LogicalFileName</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> DummyTrans</span><br><span class="line"><span class="keyword">SET</span> NOCOUNT OFF</span><br><span class="line"><span class="number">8</span>、说明：更改某个表</span><br><span class="line"><span class="keyword">exec</span> sp_changeobjectowner &quot;tablename&quot;,&quot;dbo&quot;</span><br><span class="line"><span class="number">9</span>、存储更改全部表</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> dbo.User_ChangeObjectOwnerBatch</span><br><span class="line"><span class="variable">@OldOwner</span> <span class="keyword">as</span> NVARCHAR(<span class="number">128</span>),</span><br><span class="line"><span class="variable">@NewOwner</span> <span class="keyword">as</span> NVARCHAR(<span class="number">128</span>)</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@Name</span>    <span class="keyword">as</span> NVARCHAR(<span class="number">128</span>)</span><br><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@Owner</span>   <span class="keyword">as</span> NVARCHAR(<span class="number">128</span>)</span><br><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@OwnerName</span>   <span class="keyword">as</span> NVARCHAR(<span class="number">128</span>)</span><br><span class="line"><span class="keyword">DECLARE</span> curObject <span class="keyword">CURSOR</span> <span class="keyword">FOR</span></span><br><span class="line"><span class="keyword">select</span> &quot;Name&quot;    <span class="operator">=</span> name,</span><br><span class="line">   &quot;Owner&quot;    <span class="operator">=</span> user_name(uid)</span><br><span class="line"><span class="keyword">from</span> sysobjects</span><br><span class="line"><span class="keyword">where</span> user_name(uid)<span class="operator">=</span><span class="variable">@OldOwner</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> name</span><br><span class="line"><span class="keyword">OPEN</span>   curObject</span><br><span class="line"><span class="keyword">FETCH</span> NEXT <span class="keyword">FROM</span> curObject <span class="keyword">INTO</span> <span class="variable">@Name</span>, <span class="variable">@Owner</span></span><br><span class="line">WHILE(@<span class="variable">@FETCH</span>_STATUS<span class="operator">=</span><span class="number">0</span>)</span><br><span class="line"><span class="keyword">BEGIN</span>    </span><br><span class="line">if <span class="variable">@Owner</span><span class="operator">=</span><span class="variable">@OldOwner</span> </span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="keyword">set</span> <span class="variable">@OwnerName</span> <span class="operator">=</span> <span class="variable">@OldOwner</span> <span class="operator">+</span> &quot;.&quot; <span class="operator">+</span> rtrim(<span class="variable">@Name</span>)</span><br><span class="line">   <span class="keyword">exec</span> sp_changeobjectowner <span class="variable">@OwnerName</span>, <span class="variable">@NewOwner</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">-- select @name,@NewOwner,@OldOwner</span></span><br><span class="line"><span class="keyword">FETCH</span> NEXT <span class="keyword">FROM</span> curObject <span class="keyword">INTO</span> <span class="variable">@Name</span>, <span class="variable">@Owner</span></span><br><span class="line"><span class="keyword">END</span></span><br><span class="line"><span class="keyword">close</span> curObject</span><br><span class="line"><span class="keyword">deallocate</span> curObject</span><br><span class="line">GO</span><br><span class="line"> </span><br><span class="line"><span class="number">10</span>、<span class="keyword">SQL</span> SERVER中直接循环写入数据</span><br><span class="line"><span class="keyword">declare</span> <span class="variable">@i</span> <span class="type">int</span></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@i</span><span class="operator">=</span><span class="number">1</span></span><br><span class="line">while <span class="variable">@i</span><span class="operator">&lt;</span><span class="number">30</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">insert</span> <span class="keyword">into</span> test (userid) <span class="keyword">values</span>(<span class="variable">@i</span>)</span><br><span class="line">    <span class="keyword">set</span> <span class="variable">@i</span><span class="operator">=</span><span class="variable">@i</span><span class="operator">+</span><span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">案例：</span><br><span class="line">有如下表，要求就裱中所有沒有及格的成績，在每次增長<span class="number">0.1</span>的基礎上，使他們剛好及格:</span><br><span class="line">    Name     score</span><br><span class="line">    Zhangshan   <span class="number">80</span></span><br><span class="line">    Lishi       <span class="number">59</span></span><br><span class="line">    Wangwu      <span class="number">50</span></span><br><span class="line">    Songquan    <span class="number">69</span></span><br><span class="line">while((<span class="keyword">select</span> <span class="built_in">min</span>(score) <span class="keyword">from</span> tb_table)<span class="operator">&lt;</span><span class="number">60</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">update tb_table <span class="keyword">set</span> score <span class="operator">=</span>score<span class="operator">*</span><span class="number">1.01</span> </span><br><span class="line"><span class="keyword">where</span> score<span class="operator">&lt;</span><span class="number">60</span></span><br><span class="line">if  (<span class="keyword">select</span> <span class="built_in">min</span>(score) <span class="keyword">from</span> tb_table)<span class="operator">&gt;</span><span class="number">60</span></span><br><span class="line">  break</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line">    continue</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line">数据开发<span class="operator">-</span>经典</span><br><span class="line"> </span><br><span class="line"><span class="number">1.</span>按姓氏笔画排序:</span><br><span class="line"><span class="keyword">Select</span> <span class="operator">*</span> <span class="keyword">From</span> TableName <span class="keyword">Order</span> <span class="keyword">By</span> CustomerName <span class="keyword">Collate</span> Chinese_PRC_Stroke_ci_as <span class="operator">/</span><span class="operator">/</span>从少到多</span><br><span class="line"><span class="number">2.</span>数据库加密:</span><br><span class="line"><span class="keyword">select</span> encrypt(&quot;原始密码&quot;)</span><br><span class="line"><span class="keyword">select</span> pwdencrypt(&quot;原始密码&quot;)</span><br><span class="line"><span class="keyword">select</span> pwdcompare(&quot;原始密码&quot;,&quot;加密后密码&quot;) <span class="operator">=</span> <span class="number">1</span><span class="comment">--相同；否则不相同 encrypt(&quot;原始密码&quot;)</span></span><br><span class="line"><span class="keyword">select</span> pwdencrypt(&quot;原始密码&quot;)</span><br><span class="line"><span class="keyword">select</span> pwdcompare(&quot;原始密码&quot;,&quot;加密后密码&quot;) <span class="operator">=</span> <span class="number">1</span><span class="comment">--相同；否则不相同</span></span><br><span class="line"><span class="number">3.</span>取回表中字段:</span><br><span class="line"><span class="keyword">declare</span> <span class="variable">@list</span> <span class="type">varchar</span>(<span class="number">1000</span>),</span><br><span class="line"><span class="variable">@sql</span> nvarchar(<span class="number">1000</span>) </span><br><span class="line"><span class="keyword">select</span> <span class="variable">@list</span><span class="operator">=</span><span class="variable">@list</span><span class="operator">+</span>&quot;,&quot;<span class="operator">+</span>b.name <span class="keyword">from</span> sysobjects a,syscolumns b <span class="keyword">where</span> a.id<span class="operator">=</span>b.id <span class="keyword">and</span> a.name<span class="operator">=</span>&quot;表A&quot;</span><br><span class="line"><span class="keyword">set</span> <span class="variable">@sql</span><span class="operator">=</span>&quot;select &quot;<span class="operator">+</span><span class="keyword">right</span>(<span class="variable">@list</span>,len(<span class="variable">@list</span>)<span class="number">-1</span>)<span class="operator">+</span>&quot; from 表A&quot;</span><br><span class="line"><span class="keyword">exec</span> (<span class="variable">@sql</span>)</span><br><span class="line"><span class="number">4.</span>查看硬盘分区:</span><br><span class="line"><span class="keyword">EXEC</span> master..xp_fixeddrives</span><br><span class="line"><span class="number">5.</span>比较A,B表是否相等:</span><br><span class="line">if (<span class="keyword">select</span> checksum_agg(binary_checksum(<span class="operator">*</span>)) <span class="keyword">from</span> A)</span><br><span class="line">     <span class="operator">=</span></span><br><span class="line">    (<span class="keyword">select</span> checksum_agg(binary_checksum(<span class="operator">*</span>)) <span class="keyword">from</span> B)</span><br><span class="line">print &quot;相等&quot;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">print &quot;不相等&quot;</span><br><span class="line"><span class="number">6.</span>杀掉所有的事件探察器进程:</span><br><span class="line"><span class="keyword">DECLARE</span> hcforeach <span class="keyword">CURSOR</span> <span class="keyword">GLOBAL</span> <span class="keyword">FOR</span> <span class="keyword">SELECT</span> &quot;kill &quot;<span class="operator">+</span>RTRIM(spid) <span class="keyword">FROM</span> master.dbo.sysprocesses</span><br><span class="line"><span class="keyword">WHERE</span> program_name <span class="keyword">IN</span>(&quot;SQL profiler&quot;,N&quot;SQL 事件探查器&quot;)</span><br><span class="line"><span class="keyword">EXEC</span> sp_msforeach_worker &quot;?&quot;</span><br><span class="line"><span class="number">7.</span>记录搜索:</span><br><span class="line">开头到N条记录</span><br><span class="line"><span class="keyword">Select</span> Top N <span class="operator">*</span> <span class="keyword">From</span> 表</span><br><span class="line"><span class="comment">-------------------------------</span></span><br><span class="line">N到M条记录(要有主索引ID)</span><br><span class="line"><span class="keyword">Select</span> Top M<span class="operator">-</span>N <span class="operator">*</span> <span class="keyword">From</span> 表 <span class="keyword">Where</span> ID <span class="keyword">in</span> (<span class="keyword">Select</span> Top M ID <span class="keyword">From</span> 表) <span class="keyword">Order</span> <span class="keyword">by</span> ID   <span class="keyword">Desc</span></span><br><span class="line"><span class="comment">----------------------------------</span></span><br><span class="line">N到结尾记录</span><br><span class="line"><span class="keyword">Select</span> Top N <span class="operator">*</span> <span class="keyword">From</span> 表 <span class="keyword">Order</span> <span class="keyword">by</span> ID <span class="keyword">Desc</span></span><br><span class="line">案例</span><br><span class="line">例如<span class="number">1</span>：一张表有一万多条记录，表的第一个字段 RecID 是自增长字段， 写一个<span class="keyword">SQL</span>语句， 找出表的第<span class="number">31</span>到第<span class="number">40</span>个记录。</span><br><span class="line"> <span class="keyword">select</span> top <span class="number">10</span> recid <span class="keyword">from</span> A <span class="keyword">where</span> recid <span class="keyword">not</span>  <span class="keyword">in</span>(<span class="keyword">select</span> top <span class="number">30</span> recid <span class="keyword">from</span> A)</span><br><span class="line">分析：如果这样写会产生某些问题，如果recid在表中存在逻辑索引。</span><br><span class="line">    <span class="keyword">select</span> top <span class="number">10</span> recid <span class="keyword">from</span> A <span class="keyword">where</span>……是从索引中查找，而后面的<span class="keyword">select</span> top <span class="number">30</span> recid <span class="keyword">from</span> A则在数据表中查找，这样由于索引中的顺序有可能和数据表中的不一致，这样就导致查询到的不是本来的欲得到的数据。</span><br><span class="line">解决方案</span><br><span class="line"><span class="number">1</span>，  用<span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">select</span> top <span class="number">30</span> recid <span class="keyword">from</span> A <span class="keyword">order</span> <span class="keyword">by</span> ricid 如果该字段不是自增长，就会出现问题</span><br><span class="line"><span class="number">2</span>，  在那个子查询中也加条件：<span class="keyword">select</span> top <span class="number">30</span> recid <span class="keyword">from</span> A <span class="keyword">where</span> recid<span class="operator">&gt;</span><span class="number">-1</span></span><br><span class="line">例<span class="number">2</span>：查询表中的最后以条记录，并不知道这个表共有多少数据,以及表结构。</span><br><span class="line"><span class="keyword">set</span> <span class="variable">@s</span> <span class="operator">=</span> &quot;select top 1 * from T   where pid not in (select top &quot; <span class="operator">+</span> str(<span class="variable">@count</span><span class="number">-1</span>) <span class="operator">+</span> &quot; pid  from  T)&quot;</span><br><span class="line">print <span class="variable">@s</span>      <span class="keyword">exec</span>  sp_executesql  <span class="variable">@s</span></span><br><span class="line"><span class="number">9</span>：获取当前数据库中的所有用户表</span><br><span class="line"><span class="keyword">select</span> Name <span class="keyword">from</span> sysobjects <span class="keyword">where</span> xtype<span class="operator">=</span>&quot;u&quot; <span class="keyword">and</span> status<span class="operator">&gt;=</span><span class="number">0</span></span><br><span class="line"><span class="number">10</span>：获取某一个表的所有字段</span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">from</span> syscolumns <span class="keyword">where</span> id<span class="operator">=</span>object_id(&quot;表名&quot;)</span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">from</span> syscolumns <span class="keyword">where</span> id <span class="keyword">in</span> (<span class="keyword">select</span> id <span class="keyword">from</span> sysobjects <span class="keyword">where</span> type <span class="operator">=</span> &quot;u&quot; <span class="keyword">and</span> name <span class="operator">=</span> &quot;表名&quot;)</span><br><span class="line">两种方式的效果相同</span><br><span class="line"><span class="number">11</span>：查看与某一个表相关的视图、存储过程、函数</span><br><span class="line"><span class="keyword">select</span> a.<span class="operator">*</span> <span class="keyword">from</span> sysobjects a, syscomments b <span class="keyword">where</span> a.id <span class="operator">=</span> b.id <span class="keyword">and</span> b.text <span class="keyword">like</span> &quot;%表名%&quot;</span><br><span class="line"><span class="number">12</span>：查看当前数据库中所有存储过程</span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">as</span> 存储过程名称 <span class="keyword">from</span> sysobjects <span class="keyword">where</span> xtype<span class="operator">=</span>&quot;P&quot;</span><br><span class="line"><span class="number">13</span>：查询用户创建的所有数据库</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> master..sysdatabases D <span class="keyword">where</span> sid <span class="keyword">not</span> <span class="keyword">in</span>(<span class="keyword">select</span> sid <span class="keyword">from</span> master..syslogins <span class="keyword">where</span> name<span class="operator">=</span>&quot;sa&quot;)</span><br><span class="line">或者</span><br><span class="line"><span class="keyword">select</span> dbid, name <span class="keyword">AS</span> DB_NAME <span class="keyword">from</span> master..sysdatabases <span class="keyword">where</span> sid <span class="operator">&lt;&gt;</span> <span class="number">0x01</span></span><br><span class="line"><span class="number">14</span>：查询某一个表的字段和数据类型</span><br><span class="line"><span class="keyword">select</span> column_name,data_type <span class="keyword">from</span> information_schema.columns</span><br><span class="line"><span class="keyword">where</span> table_name <span class="operator">=</span> &quot;表名&quot;</span><br><span class="line"><span class="number">15</span>：不同服务器数据库之间的数据操作</span><br><span class="line"><span class="comment">--创建链接服务器 </span></span><br><span class="line"><span class="keyword">exec</span> sp_addlinkedserver   &quot;ITSV &quot;, &quot; &quot;, &quot;SQLOLEDB &quot;, &quot;远程服务器名或ip地址 &quot;</span><br><span class="line"><span class="keyword">exec</span> sp_addlinkedsrvlogin  &quot;ITSV &quot;, &quot;false &quot;,<span class="keyword">null</span>, &quot;用户名 &quot;, &quot;密码 &quot;</span><br><span class="line"><span class="comment">--查询示例 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> ITSV.数据库名.dbo.表名 </span><br><span class="line"><span class="comment">--导入示例 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">into</span> 表 <span class="keyword">from</span> ITSV.数据库名.dbo.表名 </span><br><span class="line"><span class="comment">--以后不再使用时删除链接服务器 </span></span><br><span class="line"><span class="keyword">exec</span> sp_dropserver  &quot;ITSV &quot;, &quot;droplogins &quot;</span><br><span class="line"> </span><br><span class="line"><span class="comment">--连接远程/局域网数据(openrowset/openquery/opendatasource) </span></span><br><span class="line"><span class="comment">--1、openrowset </span></span><br><span class="line"><span class="comment">--查询示例 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> openrowset( &quot;SQLOLEDB &quot;, &quot;sql服务器名 &quot;; &quot;用户名 &quot;; &quot;密码 &quot;,数据库名.dbo.表名) </span><br><span class="line"><span class="comment">--生成本地表 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">into</span> 表 <span class="keyword">from</span> openrowset( &quot;SQLOLEDB &quot;, &quot;sql服务器名 &quot;; &quot;用户名 &quot;; &quot;密码 &quot;,数据库名.dbo.表名) </span><br><span class="line"> </span><br><span class="line"><span class="comment">--把本地表导入远程表 </span></span><br><span class="line"><span class="keyword">insert</span> openrowset( &quot;SQLOLEDB &quot;, &quot;sql服务器名 &quot;; &quot;用户名 &quot;; &quot;密码 &quot;,数据库名.dbo.表名) </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span><span class="keyword">from</span> 本地表 </span><br><span class="line"><span class="comment">--更新本地表 </span></span><br><span class="line">update b </span><br><span class="line"><span class="keyword">set</span> b.列A<span class="operator">=</span>a.列A </span><br><span class="line"> <span class="keyword">from</span> openrowset( &quot;SQLOLEDB &quot;, &quot;sql服务器名 &quot;; &quot;用户名 &quot;; &quot;密码 &quot;,数据库名.dbo.表名)<span class="keyword">as</span> a <span class="keyword">inner</span> <span class="keyword">join</span> 本地表 b </span><br><span class="line"><span class="keyword">on</span> a.column1<span class="operator">=</span>b.column1 </span><br><span class="line"><span class="comment">--openquery用法需要创建一个连接 </span></span><br><span class="line"><span class="comment">--首先创建一个连接创建链接服务器 </span></span><br><span class="line"><span class="keyword">exec</span> sp_addlinkedserver   &quot;ITSV &quot;, &quot; &quot;, &quot;SQLOLEDB &quot;, &quot;远程服务器名或ip地址 &quot;</span><br><span class="line"><span class="comment">--查询 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> openquery(ITSV,  &quot;SELECT *  FROM 数据库.dbo.表名 &quot;) </span><br><span class="line"><span class="comment">--把本地表导入远程表 </span></span><br><span class="line"><span class="keyword">insert</span> openquery(ITSV,  &quot;SELECT *  FROM 数据库.dbo.表名 &quot;) </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 本地表 </span><br><span class="line"><span class="comment">--更新本地表 </span></span><br><span class="line">update b </span><br><span class="line"><span class="keyword">set</span> b.列B<span class="operator">=</span>a.列B </span><br><span class="line"><span class="keyword">FROM</span> openquery(ITSV,  &quot;SELECT * FROM 数据库.dbo.表名 &quot;) <span class="keyword">as</span> a  </span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> 本地表 b <span class="keyword">on</span> a.列A<span class="operator">=</span>b.列A </span><br><span class="line"> </span><br><span class="line"><span class="comment">--3、opendatasource/openrowset </span></span><br><span class="line"><span class="keyword">SELECT</span>   <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span>   opendatasource( &quot;SQLOLEDB &quot;,  &quot;Data Source=ip/ServerName;User ID=登陆名;Password=密码 &quot; ).test.dbo.roy_ta </span><br><span class="line"><span class="comment">--把本地表导入远程表 </span></span><br><span class="line"><span class="keyword">insert</span> opendatasource( &quot;SQLOLEDB &quot;,  &quot;Data Source=ip/ServerName;User ID=登陆名;Password=密码 &quot;).数据库.dbo.表名 </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 本地表  </span><br><span class="line"><span class="keyword">SQL</span> Server基本函数</span><br><span class="line"><span class="keyword">SQL</span> Server基本函数</span><br><span class="line"><span class="number">1.</span>字符串函数 长度与分析用 </span><br><span class="line"><span class="number">1</span>,datalength(Char_expr) 返回字符串包含字符数,但不包含后面的空格</span><br><span class="line"><span class="number">2</span>,<span class="built_in">substring</span>(expression,<span class="keyword">start</span>,length) 取子串，字符串的下标是从“<span class="number">1</span>”，<span class="keyword">start</span>为起始位置，length为字符串长度，实际应用中以len(expression)取得其长度</span><br><span class="line"><span class="number">3</span>,<span class="keyword">right</span>(char_expr,int_expr) 返回字符串右边第int_expr个字符，还用<span class="keyword">left</span>于之相反</span><br><span class="line"><span class="number">4</span>,isnull( check_expression , replacement_value )如果check_expression為空，則返回replacement_value的值，不為空，就返回check_expression字符操作类 </span><br><span class="line"><span class="number">5</span>,Sp_addtype 自定義數據類型</span><br><span class="line">例如：<span class="keyword">EXEC</span> sp_addtype birthday, datetime, &quot;NULL&quot;</span><br><span class="line">6,set nocount &#123;on|off&#125;</span><br><span class="line">使返回的结果中不包含有关受 Transact<span class="operator">-</span><span class="keyword">SQL</span> 语句影响的行数的信息。如果存储过程中包含的一些语句并不返回许多实际的数据，则该设置由于大量减少了网络流量，因此可显著提高性能。<span class="keyword">SET</span> NOCOUNT 设置是在执行或运行时设置，而不是在分析时设置。</span><br><span class="line"><span class="keyword">SET</span> NOCOUNT 为 <span class="keyword">ON</span> 时，不返回计数（表示受 Transact<span class="operator">-</span><span class="keyword">SQL</span> 语句影响的行数）。</span><br><span class="line"><span class="keyword">SET</span> NOCOUNT 为 OFF 时，返回计数</span><br><span class="line">常识</span><br><span class="line"> </span><br><span class="line">在<span class="keyword">SQL</span>查询中：<span class="keyword">from</span>后最多可以跟多少张表或视图：<span class="number">256</span></span><br><span class="line">在<span class="keyword">SQL</span>语句中出现 <span class="keyword">Order</span> <span class="keyword">by</span>,查询时，先排序，后取</span><br><span class="line">在<span class="keyword">SQL</span>中，一个字段的最大容量是<span class="number">8000</span>，而对于nvarchar(<span class="number">4000</span>),由于nvarchar是Unicode码。  </span><br><span class="line">     </span><br><span class="line">SQLServer2000同步复制技术实现步骤</span><br><span class="line">一、 预备工作</span><br><span class="line"><span class="number">1.</span>发布服务器,订阅服务器都创建一个同名的windows用户,并设置相同的密码,做为发布快照文件夹的有效访问用户</span><br><span class="line"><span class="comment">--管理工具</span></span><br><span class="line"><span class="comment">--计算机管理</span></span><br><span class="line"><span class="comment">--用户和组</span></span><br><span class="line"><span class="comment">--右键用户</span></span><br><span class="line"><span class="comment">--新建用户</span></span><br><span class="line"><span class="comment">--建立一个隶属于administrator组的登陆windows的用户（SynUser）</span></span><br><span class="line"><span class="number">2.</span>在发布服务器上,新建一个共享目录,做为发布的快照文件的存放目录,操作:</span><br><span class="line">我的电脑<span class="comment">--D: 新建一个目录,名为: PUB</span></span><br><span class="line"><span class="comment">--右键这个新建的目录</span></span><br><span class="line"><span class="comment">--属性--共享</span></span><br><span class="line"><span class="comment">--选择&quot;共享该文件夹&quot;</span></span><br><span class="line"><span class="comment">--通过&quot;权限&quot;按纽来设置具体的用户权限,保证第一步中创建的用户(SynUser) 具有对该文件夹的所有权限</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">--确定</span></span><br><span class="line"><span class="number">3.</span>设置<span class="keyword">SQL</span>代理(SQLSERVERAGENT)服务的启动用户(发布<span class="operator">/</span>订阅服务器均做此设置)</span><br><span class="line">开始<span class="comment">--程序--管理工具--服务</span></span><br><span class="line"><span class="comment">--右键SQLSERVERAGENT</span></span><br><span class="line"><span class="comment">--属性--登陆--选择&quot;此账户&quot;</span></span><br><span class="line"><span class="comment">--输入或者选择第一步中创建的windows登录用户名（SynUser）</span></span><br><span class="line"><span class="comment">--&quot;密码&quot;中输入该用户的密码</span></span><br><span class="line"><span class="number">4.</span>设置<span class="keyword">SQL</span> Server身份验证模式,解决连接时的权限问题(发布<span class="operator">/</span>订阅服务器均做此设置)</span><br><span class="line">企业管理器</span><br><span class="line"><span class="comment">--右键SQL实例--属性</span></span><br><span class="line"><span class="comment">--安全性--身份验证</span></span><br><span class="line"><span class="comment">--选择&quot;SQL Server 和 Windows&quot;</span></span><br><span class="line"><span class="comment">--确定</span></span><br><span class="line"><span class="number">5.</span>在发布服务器和订阅服务器上互相注册</span><br><span class="line">企业管理器</span><br><span class="line"><span class="comment">--右键SQL Server组</span></span><br><span class="line"><span class="comment">--新建SQL Server注册...</span></span><br><span class="line"><span class="comment">--下一步--可用的服务器中,输入你要注册的远程服务器名 --添加</span></span><br><span class="line"><span class="comment">--下一步--连接使用,选择第二个&quot;SQL Server身份验证&quot;</span></span><br><span class="line"><span class="comment">--下一步--输入用户名和密码（SynUser）</span></span><br><span class="line"><span class="comment">--下一步--选择SQL Server组,也可以创建一个新组</span></span><br><span class="line"><span class="comment">--下一步--完成</span></span><br><span class="line"><span class="number">6.</span>对于只能用IP,不能用计算机名的,为其注册服务器别名（此步在实施中没用到）</span><br><span class="line"> (在连接端配置,比如,在订阅服务器上配置的话,服务器名称中输入的是发布服务器的IP)</span><br><span class="line">开始<span class="comment">--程序--Microsoft SQL Server--客户端网络实用工具</span></span><br><span class="line"><span class="comment">--别名--添加</span></span><br><span class="line"><span class="comment">--网络库选择&quot;tcp/ip&quot;--服务器别名输入SQL服务器名</span></span><br><span class="line"><span class="comment">--连接参数--服务器名称中输入SQL服务器ip地址</span></span><br><span class="line"><span class="comment">--如果你修改了SQL的端口,取消选择&quot;动态决定端口&quot;,并输入对应的端口号</span></span><br><span class="line">二、 正式配置</span><br><span class="line"><span class="number">1</span>、配置发布服务器</span><br><span class="line">打开企业管理器，在发布服务器（B、C、D）上执行以下步骤:</span><br><span class="line">(<span class="number">1</span>) 从[工具]下拉菜单的[复制]子菜单中选择[配置发布、订阅服务器和分发]出现配置发布和分发向导 </span><br><span class="line">(<span class="number">2</span>) [下一步] 选择分发服务器 可以选择把发布服务器自己作为分发服务器或者其他<span class="keyword">sql</span>的服务器（选择自己）</span><br><span class="line">(<span class="number">3</span>) [下一步] 设置快照文件夹</span><br><span class="line">采用默认servernamePub</span><br><span class="line">(<span class="number">4</span>) [下一步] 自定义配置 </span><br><span class="line">可以选择:是,让我设置分发数据库属性启用发布服务器或设置发布设置</span><br><span class="line">否,使用下列默认设置（推荐）</span><br><span class="line">(<span class="number">5</span>) [下一步] 设置分发数据库名称和位置 采用默认值</span><br><span class="line">(<span class="number">6</span>) [下一步] 启用发布服务器 选择作为发布的服务器</span><br><span class="line">(<span class="number">7</span>) [下一步] 选择需要发布的数据库和发布类型</span><br><span class="line">(<span class="number">8</span>) [下一步] 选择注册订阅服务器</span><br><span class="line">(<span class="number">9</span>) [下一步] 完成配置</span><br><span class="line"><span class="number">2</span>、创建出版物</span><br><span class="line">发布服务器B、C、D上</span><br><span class="line">(<span class="number">1</span>)从[工具]菜单的[复制]子菜单中选择[创建和管理发布]命令</span><br><span class="line">(<span class="number">2</span>)选择要创建出版物的数据库，然后单击[创建发布]</span><br><span class="line">(<span class="number">3</span>)在[创建发布向导]的提示对话框中单击[下一步]系统就会弹出一个对话框。对话框上的内容是复制的三个类型。我们现在选第一个也就是默认的快照发布(其他两个大家可以去看看帮助)</span><br><span class="line">(<span class="number">4</span>)单击[下一步]系统要求指定可以订阅该发布的数据库服务器类型,</span><br><span class="line">SQLSERVER允许在不同的数据库如 orACLE或ACCESS之间进行数据复制。</span><br><span class="line">但是在这里我们选择运行&quot;SQL SERVER 2000&quot;的数据库服务器</span><br><span class="line">(<span class="number">5</span>)单击[下一步]系统就弹出一个定义文章的对话框也就是选择要出版的表</span><br><span class="line">注意: 如果前面选择了事务发布 则再这一步中只能选择带有主键的表</span><br><span class="line">(<span class="number">6</span>)选择发布名称和描述</span><br><span class="line">(<span class="number">7</span>)自定义发布属性 向导提供的选择:</span><br><span class="line">是 我将自定义数据筛选,启用匿名订阅和或其他自定义属性</span><br><span class="line">否 根据指定方式创建发布 （建议采用自定义的方式）</span><br><span class="line">(<span class="number">8</span>)[下一步] 选择筛选发布的方式 </span><br><span class="line">(<span class="number">9</span>)[下一步] 可以选择是否允许匿名订阅</span><br><span class="line"><span class="number">1</span>)如果选择署名订阅,则需要在发布服务器上添加订阅服务器</span><br><span class="line">方法: [工具]<span class="operator">-</span><span class="operator">&gt;</span>[复制]<span class="operator">-</span><span class="operator">&gt;</span>[配置发布、订阅服务器和分发的属性]<span class="operator">-</span><span class="operator">&gt;</span>[订阅服务器] 中添加</span><br><span class="line">否则在订阅服务器上请求订阅时会出现的提示:改发布不允许匿名订阅</span><br><span class="line">如果仍然需要匿名订阅则用以下解决办法 </span><br><span class="line">[企业管理器]<span class="operator">-</span><span class="operator">&gt;</span>[复制]<span class="operator">-</span><span class="operator">&gt;</span>[发布内容]<span class="operator">-</span><span class="operator">&gt;</span>[属性]<span class="operator">-</span><span class="operator">&gt;</span>[订阅选项] 选择允许匿名请求订阅</span><br><span class="line"><span class="number">2</span>)如果选择匿名订阅,则配置订阅服务器时不会出现以上提示</span><br><span class="line">(<span class="number">10</span>)[下一步] 设置快照 代理程序调度</span><br><span class="line">(<span class="number">11</span>)[下一步] 完成配置</span><br><span class="line">当完成出版物的创建后创建出版物的数据库也就变成了一个共享数据库</span><br><span class="line">有数据 </span><br><span class="line">srv1.库名..author有字段:id,name,phone, </span><br><span class="line">srv2.库名..author有字段:id,name,telphone,adress </span><br><span class="line"> </span><br><span class="line">要求： </span><br><span class="line">srv1.库名..author增加记录则srv1.库名..author记录增加 </span><br><span class="line">srv1.库名..author的phone字段更新，则srv1.库名..author对应字段telphone更新 </span><br><span class="line"><span class="comment">--*/ </span></span><br><span class="line"> </span><br><span class="line"><span class="comment">--大致的处理步骤 </span></span><br><span class="line"><span class="comment">--1.在 srv1 上创建连接服务器,以便在 srv1 中操作 srv2,实现同步 </span></span><br><span class="line"><span class="keyword">exec</span> sp_addlinkedserver &quot;srv2&quot;,&quot;&quot;,&quot;SQLOLEDB&quot;,&quot;srv2的sql实例名或ip&quot;</span><br><span class="line"><span class="keyword">exec</span> sp_addlinkedsrvlogin &quot;srv2&quot;,&quot;false&quot;,<span class="keyword">null</span>,&quot;用户名&quot;,&quot;密码&quot;</span><br><span class="line">go</span><br><span class="line"><span class="comment">--2.在 srv1 和 srv2 这两台电脑中,启动 msdtc(分布式事务处理服务),并且设置为自动启动</span></span><br><span class="line">。我的电脑<span class="comment">--控制面板--管理工具--服务--右键 Distributed Transaction Coordinator--属性--启动--并将启动类型设置为自动启动 </span></span><br><span class="line">go </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">--然后创建一个作业定时调用上面的同步处理存储过程就行了 </span></span><br><span class="line"> </span><br><span class="line">企业管理器 </span><br><span class="line"><span class="comment">--管理 </span></span><br><span class="line"><span class="comment">--SQL Server代理 </span></span><br><span class="line"><span class="comment">--右键作业 </span></span><br><span class="line"><span class="comment">--新建作业 </span></span><br><span class="line"><span class="comment">--&quot;常规&quot;项中输入作业名称 </span></span><br><span class="line"><span class="comment">--&quot;步骤&quot;项 </span></span><br><span class="line"><span class="comment">--新建 </span></span><br><span class="line"><span class="comment">--&quot;步骤名&quot;中输入步骤名 </span></span><br><span class="line"><span class="comment">--&quot;类型&quot;中选择&quot;Transact-SQL 脚本(TSQL)&quot; </span></span><br><span class="line"><span class="comment">--&quot;数据库&quot;选择执行命令的数据库 </span></span><br><span class="line"><span class="comment">--&quot;命令&quot;中输入要执行的语句: exec p_process </span></span><br><span class="line"><span class="comment">--确定 </span></span><br><span class="line"><span class="comment">--&quot;调度&quot;项 </span></span><br><span class="line"><span class="comment">--新建调度 </span></span><br><span class="line"><span class="comment">--&quot;名称&quot;中输入调度名称 </span></span><br><span class="line"><span class="comment">--&quot;调度类型&quot;中选择你的作业执行安排 </span></span><br><span class="line"><span class="comment">--如果选择&quot;反复出现&quot; </span></span><br><span class="line"><span class="comment">--点&quot;更改&quot;来设置你的时间安排 </span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">然后将<span class="keyword">SQL</span> Agent服务启动,并设置为自动启动,否则你的作业不会被执行 </span><br><span class="line"> </span><br><span class="line">设置方法: </span><br><span class="line">我的电脑<span class="comment">--控制面板--管理工具--服务--右键 SQLSERVERAGENT--属性--启动类型--选择&quot;自动启动&quot;--确定. </span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">--3.实现同步处理的方法2,定时同步 </span></span><br><span class="line"> </span><br><span class="line"><span class="comment">--在srv1中创建如下的同步处理存储过程 </span></span><br><span class="line"><span class="keyword">create</span> proc p_process </span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="comment">--更新修改过的数据 </span></span><br><span class="line">update b <span class="keyword">set</span> name<span class="operator">=</span>i.name,telphone<span class="operator">=</span>i.telphone </span><br><span class="line"><span class="keyword">from</span> srv2.库名.dbo.author b,author i </span><br><span class="line"><span class="keyword">where</span> b.id<span class="operator">=</span>i.id <span class="keyword">and</span></span><br><span class="line">(b.name <span class="operator">&lt;&gt;</span> i.name <span class="keyword">or</span> b.telphone <span class="operator">&lt;&gt;</span> i.telphone) </span><br><span class="line"> </span><br><span class="line"><span class="comment">--插入新增的数据 </span></span><br><span class="line"><span class="keyword">insert</span> srv2.库名.dbo.author(id,name,telphone) </span><br><span class="line"><span class="keyword">select</span> id,name,telphone <span class="keyword">from</span> author i </span><br><span class="line"><span class="keyword">where</span> <span class="keyword">not</span> <span class="keyword">exists</span>( </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> srv2.库名.dbo.author <span class="keyword">where</span> id<span class="operator">=</span>i.id) </span><br><span class="line"> </span><br><span class="line"><span class="comment">--删除已经删除的数据(如果需要的话) </span></span><br><span class="line"><span class="keyword">delete</span> b </span><br><span class="line"><span class="keyword">from</span> srv2.库名.dbo.author b </span><br><span class="line"><span class="keyword">where</span> <span class="keyword">not</span> <span class="keyword">exists</span>( </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> author <span class="keyword">where</span> id<span class="operator">=</span>b.id)</span><br><span class="line">go</span><br></pre></td></tr></table></figure>

    </div>

    
    
    
        <div class="reward-container">
  <div>如果觉得我的文章对您有用，请随意打赏。您的支持将鼓励我继续创作！</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.jpeg" alt="泽宬 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.png" alt="泽宬 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/MySql/" rel="tag"># MySql</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2013/06/17/SQL%E8%AF%AD%E5%8F%A5%E5%AD%A6%E4%B9%A0%E6%89%8B%E5%86%8C%E5%AE%9E%E4%BE%8B%E7%89%88/" rel="prev" title="SQL语句学习手册实例版">
      <i class="fa fa-chevron-left"></i> SQL语句学习手册实例版
    </a></div>
      <div class="post-nav-item">
    <a href="/2013/06/17/mysql%E5%A4%8D%E4%B9%A0/" rel="next" title="mysql复习">
      mysql复习 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="泽宬"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">泽宬</p>
  <div class="site-description" itemprop="description">路虽遥,行必至.事虽难,做必成.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">218</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">泽宬</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">676k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">10:15</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
